@import "../../mixins.scss";

.videoPopup {
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	z-index: 9999;
	display: none;
	perspective: 1200px;

	&.visible {
		display: block;
	}

	.opacityLayer {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background: rgba(0, 0, 0, 0.95);
		transition: background 1s ease;
	}

	&.theater .opacityLayer {
		background: rgba(0, 0, 0, 1);
	}

	.cinemaEnvironment {
		position: relative;
		width: 100%;
		height: 100%;
		transform-style: preserve-3d;
		transition: all 1s ease;

		&.lightsOut {
			.theaterSeats,
			.theaterWalls {
				opacity: 0.3;
			}

			.screenGlow {
				opacity: 1;
			}
		}

		// Theater Seats
		.theaterSeats {
			position: absolute;
			bottom: 10%;
			left: 50%;
			transform: translateX(-50%) translateZ(-200px) rotateX(15deg);
			display: flex;
			flex-direction: column;
			gap: 30px;
			opacity: 0.6;
			transition: opacity 1s ease;

			@include md {
				bottom: 5%;
				gap: 20px;
				transform: translateX(-50%) translateZ(-100px) rotateX(10deg);
			}

			.seatRow {
				display: flex;
				gap: 15px;
				justify-content: center;

				@include md {
					gap: 10px;
				}

				&.front {
					.seat {
						width: 40px;
						height: 35px;

						@include md {
							width: 25px;
							height: 25px;
						}
					}
				}

				&.back {
					.seat {
						width: 35px;
						height: 30px;

						@include md {
							width: 20px;
							height: 20px;
						}
					}
				}

				.seat {
					background: linear-gradient(180deg, #8b0000 0%, #5a0000 100%);
					border-radius: 8px 8px 2px 2px;
					position: relative;
					box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);

					&::before {
						content: "";
						position: absolute;
						top: -5px;
						left: 50%;
						transform: translateX(-50%);
						width: 80%;
						height: 8px;
						background: #6a0000;
						border-radius: 4px 4px 0 0;
					}

					&.viewer {
						background: linear-gradient(180deg, #ff6b6b 0%, #ee5a6f 100%);
						box-shadow: 0 0 20px rgba(255, 107, 107, 0.6);

						&::before {
							background: #ff8888;
						}
					}
				}
			}
		}

		// Theater Walls
		.theaterWalls {
			position: absolute;
			width: 100%;
			height: 100%;
			opacity: 0.4;
			transition: opacity 1s ease;

			.wall {
				position: absolute;
				background: linear-gradient(180deg, #1a0000 0%, #0d0000 100%);

				&.left {
					left: 0;
					top: 0;
					width: 15%;
					height: 100%;
					transform: rotateY(15deg);
					transform-origin: right center;

					@include md {
						width: 10%;
					}
				}

				&.right {
					right: 0;
					top: 0;
					width: 15%;
					height: 100%;
					transform: rotateY(-15deg);
					transform-origin: left center;

					@include md {
						width: 10%;
					}
				}

				&.back {
					bottom: 0;
					left: 0;
					width: 100%;
					height: 20%;
					background: linear-gradient(0deg, #0d0000 0%, transparent 100%);
				}
			}
		}

		// Screen Glow Effect
		.screenGlow {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: 70%;
			height: 60%;
			background: radial-gradient(
				ellipse at center,
				rgba(100, 150, 255, 0.3) 0%,
				rgba(100, 150, 255, 0.1) 40%,
				transparent 70%
			);
			opacity: 0;
			transition: opacity 1.5s ease;
			pointer-events: none;
			filter: blur(40px);

			@include md {
				width: 90%;
				height: 50%;
			}
		}

		// Red Curtains
		.curtains {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			pointer-events: none;
			z-index: 10;

			.curtainTop {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 60px;
				background: linear-gradient(
					180deg,
					#8b0000 0%,
					#6a0000 50%,
					transparent 100%
				);
				box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);

				@include md {
					height: 40px;
				}
			}

			.curtain {
				position: absolute;
				top: 0;
				width: 50%;
				height: 100%;
				background: repeating-linear-gradient(
					90deg,
					#8b0000 0px,
					#a00000 20px,
					#8b0000 40px,
					#6a0000 60px,
					#8b0000 80px
				);
				box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.5);
				transition: transform 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);

				&::before {
					content: "";
					position: absolute;
					top: 0;
					width: 100%;
					height: 100%;
					background: linear-gradient(
						90deg,
						rgba(0, 0, 0, 0.3) 0%,
						transparent 50%,
						rgba(0, 0, 0, 0.3) 100%
					);
				}

				&.left {
					left: 0;
					transform-origin: left center;
				}

				&.right {
					right: 0;
					transform-origin: right center;
				}
			}

			&.open {
				.curtain.left {
					transform: translateX(-100%);
				}

				.curtain.right {
					transform: translateX(100%);
				}
			}
		}

		// Movie Screen
		.movieScreen {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%) translateZ(100px);
			width: 85%;
			max-width: 1200px;
			height: auto;
			aspect-ratio: 16 / 9;
			z-index: 5;
			display: flex;
			justify-content: center;
			align-items: center;

			// Safety for extremely tall screens
			max-height: 80vh;

			@include md {
				width: 95%;
				max-height: 70vh;
				transform: translate(-50%, -50%) translateZ(50px);
			}

			.screenFrame {
				width: 100%;
				height: 100%;
				background: #000;
				border: 15px solid #1a1a1a;
				border-radius: 8px;
				box-shadow:
					0 20px 60px rgba(0, 0, 0, 0.9),
					inset 0 0 30px rgba(255, 255, 255, 0.05);
				position: relative;
				overflow: hidden;

				@include md {
					border: 8px solid #1a1a1a;
				}

				.videoPlayer {
					width: 100%;
					height: 100%;
					position: relative;
					display: flex;
					justify-content: center;
					align-items: center;
					background: #000;

					.closeBtn {
						position: absolute;
						top: 15px;
						right: 15px;
						background: rgba(0, 0, 0, 0.8);
						color: white;
						padding: 10px 20px;
						border-radius: 25px;
						cursor: pointer;
						z-index: 100;
						font-size: 14px;
						font-weight: 600;
						transition: all 0.3s ease;
						border: 2px solid rgba(255, 255, 255, 0.2);
						backdrop-filter: blur(10px);
						white-space: nowrap;

						&:hover {
							background: rgba(255, 59, 48, 0.9);
							transform: scale(1.05);
							border-color: rgba(255, 59, 48, 0.5);
						}

						@include md {
							top: 10px;
							right: 10px;
							padding: 6px 12px;
							font-size: 11px;
						}
					}

					// Ensure the actual video fills the frame correctly
					iframe,
					video {
						width: 100% !important;
						height: 100% !important;
						object-fit: contain;
					}
				}
			}
		}

		// Theater Controls
		.theaterControls {
			position: absolute;
			bottom: 30px;
			right: 30px;
			z-index: 100;

			@include md {
				bottom: 15px;
				right: 15px;
			}

			.modeToggle {
				background: rgba(0, 0, 0, 0.7);
				color: white;
				padding: 12px 20px;
				border-radius: 25px;
				border: 2px solid rgba(255, 255, 255, 0.2);
				cursor: pointer;
				font-size: 14px;
				font-weight: 600;
				transition: all 0.3s ease;
				backdrop-filter: blur(10px);

				&:hover {
					background: rgba(255, 255, 255, 0.1);
					border-color: rgba(255, 255, 255, 0.4);
					transform: translateY(-2px);
				}

				@include md {
					padding: 8px 14px;
					font-size: 12px;
				}
			}
		}
	}
}

// Animation for theater entrance
@keyframes fadeIn {
	from {
		opacity: 0;
	}
	to {
		opacity: 1;
	}
}

@keyframes slideDown {
	from {
		transform: translateY(-100%);
	}
	to {
		transform: translateY(0);
	}
}
